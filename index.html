<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>AI Trendboard</title>
  <style>
    :root { color-scheme: light dark; }

    html, body { height: 100%; }
    body {
      margin: 0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      display: flex;
      flex-direction: column;
    }
    main { flex: 1; }

    header {
      position: sticky; top: 0;
      background: rgba(255,255,255,.9);
      backdrop-filter: blur(8px);
      border-bottom: 1px solid rgba(0,0,0,.12);
      z-index: 10;
    }
    @media (prefers-color-scheme: dark) {
      header { background: rgba(20,20,20,.85); border-bottom-color: rgba(255,255,255,.14); }
    }

    .wrap { max-width: 1200px; margin: 0 auto; padding: 14px; }
    h1 { margin: 0; font-size: 16px; font-weight: 800; }
    .hint { font-size: 12px; opacity: .75; line-height: 1.45; margin-top: 6px; }

    .sectionTitle {
      margin: 16px 0 8px;
      font-size: 12px;
      letter-spacing: .08em;
      text-transform: uppercase;
      opacity: .7;
      color: #0020C2;
    }

    .subToolbar {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      align-items: center;
      margin: 6px 0 10px;
      font-size: 12px;
      opacity: .92;
    }
    .subToolbar .sep { opacity: .55; }

    .select, .text {
      font-size: 12px;
      padding: 7px 10px;
      border-radius: 10px;
      border: 1px solid rgba(0,0,0,.18);
      background: transparent;
      opacity: .95;
      outline: none;
    }
    .text { min-width: 220px; }
    @media (prefers-color-scheme: dark) {
      .select, .text { border-color: rgba(255,255,255,.18); }
    }

    .badge {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      font-size: 11px;
      padding: 3px 9px;
      border-radius: 999px;
      border: 1px solid rgba(0,0,0,.14);
      opacity: .9;
      white-space: nowrap;
    }
    @media (prefers-color-scheme: dark) {
      .badge { border-color: rgba(255,255,255,.18); }
    }

    .grid {
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 10px;
    }
    @media (max-width: 860px) {
      .grid { grid-template-columns: 1fr; }
    }

    .item {
      border: 1px solid rgba(0,0,0,.12);
      border-radius: 14px;
      padding: 12px;
      display: flex;
      gap: 12px;
      justify-content: space-between;
      align-items: flex-start;
    }
    @media (prefers-color-scheme: dark) {
      .item { border-color: rgba(255,255,255,.14); }
    }

    .left { flex: 1; display: grid; gap: 6px; min-width: 0; }
    .top { display: flex; gap: 8px; align-items: center; min-width: 0; }
    .tag {
      font-size: 11px; padding: 2px 8px;
      border-radius: 999px;
      border: 1px solid rgba(0,0,0,.14);
      opacity: .8;
      white-space: nowrap;
    }

    .title {
      font-size: 13px;
      font-weight: 800;
      cursor: pointer;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .desc { font-size: 12px; opacity: .78; line-height: 1.45; }
    .tip  { font-size: 12px; opacity: .72; line-height: 1.45; }

    .metaLine {
      font-size: 12px;
      opacity: .78;
      display: flex;
      gap: 8px;
      align-items: center;
      flex-wrap: wrap;
      margin-top: 2px;
    }
    .metaPill {
      font-size: 11px;
      padding: 2px 8px;
      border-radius: 999px;
      border: 1px solid rgba(0,0,0,.14);
      opacity: .85;
      white-space: nowrap;
    }
    @media (prefers-color-scheme: dark) {
      .metaPill { border-color: rgba(255,255,255,.18); }
    }

    .actions {
      display: grid;
      gap: 8px;
      min-width: 210px;
    }
    .btn {
      font-size: 12px;
      padding: 7px 10px;
      border-radius: 999px;
      border: 1px solid rgba(0,0,0,.18);
      background: transparent;
      cursor: pointer;
      opacity: .92;
      white-space: nowrap;
      text-align: center;
    }
    @media (prefers-color-scheme: dark) {
      .btn { border-color: rgba(255,255,255,.18); }
    }
    .btn:hover { opacity: 1; }

    .btnRow {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 8px;
    }

    /* --- Trend keyword list --- */
    .kwWrap { display: grid; gap: 6px; margin-top: 2px; }
    .kwRow {
      display: grid;
      grid-template-columns: 1fr 90px;
      gap: 10px;
      align-items: center;
      font-size: 12px;
      opacity: .92;
    }
    .kwWord { min-width: 0; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
    .kwBarWrap {
      height: 8px;
      border-radius: 999px;
      border: 1px solid rgba(0,0,0,.14);
      overflow: hidden;
      opacity: .9;
    }
    .kwBar {
      height: 100%;
      width: 0%;
      background: currentColor;
      opacity: .35;
    }
    @media (prefers-color-scheme: dark) {
      .kwBarWrap { border-color: rgba(255,255,255,.18); }
      .kwBar { opacity: .45; }
    }
    .kwMeta { font-size: 12px; opacity: .72; line-height: 1.45; }
    .mono { font-variant-numeric: tabular-nums; font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; }

    /* --- footer / history --- */
    footer {
      padding: 18px 0 24px;
      text-align: center;
      font-size: 12px;
      opacity: .75;
    }

    .historyWrap {
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 14px 18px;
      text-align: left;
    }

    .historyHeader {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 10px;
      margin: 10px 0 8px;
    }

    .historyTitle {
      font-size: 12px;
      letter-spacing: .08em;
      text-transform: uppercase;
      opacity: .7;
      margin: 0;
    }

    .historyList {
      border: 1px solid rgba(0,0,0,.12);
      border-radius: 14px;
      overflow: hidden;
    }
    @media (prefers-color-scheme: dark) {
      .historyList { border-color: rgba(255,255,255,.14); }
    }

    .hrow {
      display: grid;
      grid-template-columns: 170px 1fr 110px;
      gap: 10px;
      padding: 10px 12px;
      align-items: center;
      border-top: 1px solid rgba(0,0,0,.08);
      cursor: pointer;
    }
    .hrow:first-child { border-top: 0; }
    @media (prefers-color-scheme: dark) {
      .hrow { border-top-color: rgba(255,255,255,.10); }
    }
    @media (max-width: 720px) {
      .hrow { grid-template-columns: 1fr; gap: 6px; }
    }

    .htime { font-size: 12px; opacity: .75; white-space: nowrap; }
    .htext { font-size: 12px; opacity: .9; min-width: 0; }
    .htext b { font-weight: 800; }
    .hopen {
      justify-self: end;
      font-size: 12px;
      opacity: .8;
      text-align: right;
      white-space: nowrap;
    }
    @media (max-width: 720px) {
      .hopen { justify-self: start; text-align: left; }
    }

    .muted { opacity: .65; }

    /* --- Trend Pulse keyword bars --- */
    .kwList { display: grid; gap: 6px; }
    .kwRow {
      display: grid;
      grid-template-columns: 28px 1fr 180px;
      gap: 8px;
      align-items: center;
      font-size: 12px;
      opacity: .92;
    }
    @media (max-width: 720px) {
      .kwRow { grid-template-columns: 28px 1fr 150px; }
    }
    .kwRank { opacity: .6; font-variant-numeric: tabular-nums; }
    .kwWord { white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
    .kwBar {
      height: 8px;
      border-radius: 999px;
      border: 1px solid rgba(0,0,0,.16);
      overflow: hidden;
      opacity: .9;
    }
    .kwBar > span {
      display: block;
      height: 100%;
      background: rgba(0,32,194,.55);
      width: 0%;
    }
    .kwCount { text-align: right; opacity: .75; font-variant-numeric: tabular-nums; }
    @media (prefers-color-scheme: dark) {
      .kwBar { border-color: rgba(255,255,255,.18); }
      .kwBar > span { background: rgba(120,160,255,.6); }
    }

    .kwRowSimple{
      display: grid;
      grid-template-columns: 1fr 170px;
      gap: 12px;
      align-items: center;
      font-size: 12px;
      opacity: .92;
    }
    @media (max-width: 720px) {
      .kwRowSimple{ grid-template-columns: 1fr 120px; }
    }
    .kwCountInline{ opacity: .7; font-variant-numeric: tabular-nums; }

    /* --- Trend headlines list (Top 10) --- */
    #grid-trends .item { height: 100%; align-self: stretch; }

    /* --- Trend Pulse layout (make both cards same height + inner scroll) --- */
    /*
    .trendCard{
      height: var(--trend-card-h);
      align-items: stretch; 
    }
    */

.trendCard{
  height: auto;                 /* ê³ ì • ë†’ì´ ì œê±° */
  max-height: min(420px, 72vh); /* ìµœëŒ€ë§Œ ì œí•œ */
  align-items: stretch;
}


    .trendCard .left{
      display: flex;
      flex-direction: column;
      min-height: 0; /* í•µì‹¬: ìŠ¤í¬ë¡¤ ê°€ëŠ¥í•œ flex child í—ˆìš© */
    }
    .trendCard .actions{
      align-content: start;
    }
    .trendBody{
      margin-top: 8px;
      flex: 1;
      min-height: 0;    /* í•µì‹¬ */
      overflow: auto;   /* í•µì‹¬ */
      padding-right: 2px;
    }


    
    /* --- Latest news list (more compact) --- */
    .newsList{ display: grid; gap: 8px; }
    .newsItem{
      border: 1px solid rgba(0,0,0,.10);
      border-radius: 12px;
      padding: 8px 10px;
      cursor: pointer;
    }
    .newsItem:hover{ opacity: .95; }
    .newsTitle{
      font-size: 12px;
      font-weight: 800;
      line-height: 1.25;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow: hidden;
    }
    .newsDomain{
      margin-top: 4px;
      font-size: 11px;
      opacity: .7;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    @media (prefers-color-scheme: dark){
      .newsItem{ border-color: rgba(255,255,255,.14); }
    }

    /* (ì„ íƒ) mask-image ë°©ì‹ */
    .trendMask {
      overflow: auto;
      -webkit-mask-image: linear-gradient(to bottom, #000 0%, #000 calc(100% - 26px), transparent 100%);
              mask-image: linear-gradient(to bottom, #000 0%, #000 calc(100% - 26px), transparent 100%);
    }

    /* ì¶”ì²œ: í˜ì´ë“œ ì˜¤ë²„ë ˆì´ ë°©ì‹ (ì•ˆì •ì ) */
    .trendFade {
      position: relative;
      overflow: auto;
    }
    .trendFade::after {
      content: "";
      position: sticky;
      bottom: 0;
      left: 0;
      right: 0;
      height: 34px;
      pointer-events: none;
      background: linear-gradient(to bottom, rgba(255,255,255,0), rgba(255,255,255,1));
    }
    @media (prefers-color-scheme: dark) {
      .trendFade::after {
        background: linear-gradient(to bottom, rgba(20,20,20,0), rgba(20,20,20,1));
      }
    }








/* --- Top Keywords UI (image-like) --- */
.kw2List{
  display: grid;
  gap: 10px;
  margin-top: 8px;
}

.kw2Row{
  display: grid;
  grid-template-columns: 1fr 180px;
  gap: 14px;
  align-items: center;
}

@media (max-width: 720px){
  .kw2Row{ grid-template-columns: 1fr 150px; }
}

.kw2Word{
  font-size: 13px;
  font-weight: 700;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.kw2Word .kw2Count{
  font-weight: 600;
  opacity: .55;
}

.kw2Bar{
  height: 14px;
  border-radius: 999px;
  border: 2px solid rgba(0,0,0,.12);
  background: rgba(0,0,0,.03);
  overflow: hidden;
}

.kw2Bar > span{
  display: block;
  height: 100%;
  width: 0%;
  background: rgba(0,0,0,.28);
}

@media (prefers-color-scheme: dark){
  .kw2Bar{
    border-color: rgba(255,255,255,.18);
    background: rgba(255,255,255,.05);
  }
  .kw2Bar > span{
    background: rgba(255,255,255,.32);
  }
}

.kw2Foot{
  margin-top: 14px;
  font-size: 12px;
  opacity: .75;
  line-height: 1.45;
}



















/* =========================
   UI polish overrides (CSS only)
   Paste at the END of <style>
   ========================= */

:root{
  --accent: #0020C2;
  --border: rgba(0,0,0,.10);
  --border-strong: rgba(0,0,0,.14);
  --bg-soft: rgba(255,255,255,.72);
  --shadow: 0 10px 30px rgba(0,0,0,.08);
  --shadow-sm: 0 6px 18px rgba(0,0,0,.06);
  --ring: 0 0 0 4px rgba(0,32,194,.14);
  --radius: 16px;
}

@media (prefers-color-scheme: dark){
  :root{
    --border: rgba(255,255,255,.12);
    --border-strong: rgba(255,255,255,.16);
    --bg-soft: rgba(20,20,20,.60);
    --shadow: 0 10px 30px rgba(0,0,0,.35);
    --shadow-sm: 0 6px 18px rgba(0,0,0,.28);
    --ring: 0 0 0 4px rgba(120,160,255,.16);
  }
}

/* page background: subtle depth */
body{
  background:
    radial-gradient(1200px 500px at 18% -10%, rgba(0,32,194,.08), transparent 60%),
    radial-gradient(900px 420px at 85% 0%, rgba(0,0,0,.06), transparent 55%),
    linear-gradient(to bottom, rgba(255,255,255,.0), rgba(0,0,0,.02));
}
@media (prefers-color-scheme: dark){
  body{
    background:
      radial-gradient(1200px 500px at 18% -10%, rgba(120,160,255,.10), transparent 60%),
      radial-gradient(900px 420px at 85% 0%, rgba(255,255,255,.05), transparent 55%),
      linear-gradient(to bottom, rgba(0,0,0,.0), rgba(255,255,255,.03));
  }
}

/* header: cleaner glass */
header{
  background: rgba(255,255,255,.78) !important;
  border-bottom: 1px solid var(--border) !important;
  box-shadow: 0 6px 24px rgba(0,0,0,.06);
}
@media (prefers-color-scheme: dark){
  header{
    background: rgba(18,18,18,.72) !important;
    box-shadow: 0 10px 28px rgba(0,0,0,.40);
  }
}

/* typography spacing */
.wrap{ padding: 16px !important; }
h1{ letter-spacing: -0.01em; }
.hint{ opacity: .78 !important; }

/* section title: more â€œproductâ€ */
.sectionTitle{
  color: var(--accent) !important;
  opacity: .82 !important;
  letter-spacing: .10em !important;
  margin: 18px 0 10px !important;
}

/* grid spacing slightly roomier */
.grid{ gap: 12px !important; }

/* cards */
.item{
  border: 1px solid var(--border) !important;
  border-radius: var(--radius) !important;
  background: var(--bg-soft);
  box-shadow: var(--shadow-sm);
  padding: 14px !important;
  transition: transform .15s ease, box-shadow .15s ease, border-color .15s ease;
}
.item:hover{
  transform: translateY(-1px);
  box-shadow: var(--shadow);
  border-color: var(--border-strong) !important;
}

/* left area spacing */
.left{ gap: 8px !important; }

/* tag / pills / badge */
.tag, .metaPill, .badge{
  border-color: var(--border-strong) !important;
  background: rgba(0,0,0,.03);
}
@media (prefers-color-scheme: dark){
  .tag, .metaPill, .badge{
    background: rgba(255,255,255,.04);
  }
}
.tag{
  font-weight: 700;
  letter-spacing: .02em;
}
.metaPill{
  font-weight: 650;
}
.badge{
  font-weight: 700;
}

/* titles */
.title{
  font-size: 14px !important;
  letter-spacing: -0.01em;
}
.title:hover{ text-decoration: underline; text-underline-offset: 3px; }

/* inputs */
.select, .text{
  border-color: var(--border-strong) !important;
  border-radius: 12px !important;
  background: rgba(255,255,255,.55);
  transition: box-shadow .15s ease, border-color .15s ease, background .15s ease;
}
@media (prefers-color-scheme: dark){
  .select, .text{
    background: rgba(255,255,255,.04);
  }
}
.select:focus, .text:focus{
  outline: none;
  box-shadow: var(--ring);
  border-color: rgba(0,32,194,.35) !important;
}

/* buttons */
.btn{
  border-color: var(--border-strong) !important;
  border-radius: 999px !important;
  background: rgba(255,255,255,.40);
  transition: transform .12s ease, box-shadow .15s ease, opacity .15s ease, background .15s ease;
}
@media (prefers-color-scheme: dark){
  .btn{ background: rgba(255,255,255,.04); }
}
.btn:hover{
  opacity: 1 !important;
  transform: translateY(-1px);
  box-shadow: 0 10px 18px rgba(0,0,0,.10);
}
.btn:active{
  transform: translateY(0px) scale(.99);
  box-shadow: none;
}
.btn:focus-visible{
  outline: none;
  box-shadow: var(--ring);
}

/* Trend cards: make action column feel aligned */
.actions{
  gap: 10px !important;
  min-width: 210px;
}
.btnRow{ gap: 10px !important; }

/* Scroll areas: prettier (works in modern browsers) */
.trendBody{
  scrollbar-width: thin;
  scrollbar-color: rgba(0,0,0,.25) transparent;
}
.trendBody::-webkit-scrollbar{ width: 10px; }
.trendBody::-webkit-scrollbar-thumb{
  background: rgba(0,0,0,.18);
  border-radius: 999px;
  border: 3px solid transparent;
  background-clip: padding-box;
}
@media (prefers-color-scheme: dark){
  .trendBody{
    scrollbar-color: rgba(255,255,255,.25) transparent;
  }
  .trendBody::-webkit-scrollbar-thumb{
    background: rgba(255,255,255,.18);
    border: 3px solid transparent;
    background-clip: padding-box;
  }
}

/* Latest news items: more tappable, more depth */
.newsItem{
  border-color: var(--border) !important;
  background: rgba(255,255,255,.42);
  transition: transform .12s ease, box-shadow .15s ease, border-color .15s ease;
}
@media (prefers-color-scheme: dark){
  .newsItem{ background: rgba(255,255,255,.04); }
}
.newsItem:hover{
  transform: translateY(-1px);
  box-shadow: 0 10px 18px rgba(0,0,0,.10);
  border-color: var(--border-strong) !important;
}

/* Fade overlay: match new card background */
.trendFade::after{
  background: linear-gradient(to bottom, rgba(255,255,255,0), rgba(255,255,255,.92)) !important;
}
@media (prefers-color-scheme: dark){
  .trendFade::after{
    background: linear-gradient(to bottom, rgba(18,18,18,0), rgba(18,18,18,.92)) !important;
  }
}

/* Top Keywords (kw2) polish: more â€œUI barâ€ */
.kw2List{ gap: 12px !important; }
.kw2Row{ gap: 16px !important; }
.kw2Word{ letter-spacing: -0.01em; }
.kw2Word .kw2Count{ opacity: .55 !important; }

.kw2Bar{
  height: 5px !important;
  border: 1px solid var(--border-strong) !important;
  background: rgba(0,0,0,.04) !important;
  box-shadow: inset 0 1px 0 rgba(255,255,255,.6);
}
@media (prefers-color-scheme: dark){
  .kw2Bar{
    background: rgba(255,255,255,.06) !important;
    box-shadow: inset 0 1px 0 rgba(255,255,255,.08);
  }
}
.kw2Bar > span{
  background: linear-gradient(90deg, rgba(0,0,0,.18), rgba(0,0,0,.34)) !important;
}
@media (prefers-color-scheme: dark){
  .kw2Bar > span{
    background: linear-gradient(90deg, rgba(255,255,255,.18), rgba(255,255,255,.30)) !important;
  }
}

/* History list row hover */
.hrow{
  transition: background .12s ease, border-color .12s ease;
}
.hrow:hover{
  background: rgba(0,0,0,.03);
}
@media (prefers-color-scheme: dark){
  .hrow:hover{ background: rgba(255,255,255,.04); }
}

/* Small polish */
.muted{ opacity: .68 !important; }
.tip{ opacity: .78 !important; }



  </style>
</head>

<body>
<header>
  <div class="wrap">
    <h1>AI Trendboard</h1>
    <div class="hint">
      AI íŠ¸ë Œë“œ/ì–¸ì–´/ë²¤ì¹˜ë§ˆí¬/ì±„ìš© ì‹œê·¸ë„
    </div>

    <!-- NEW: Trend pulse -->
    <div class="sectionTitle">AI íŠ¸ë Œë“œ</div>
    <div class="grid" id="grid-trends"></div>

    <div class="sectionTitle">íƒìƒ‰</div>
    <div class="grid" id="grid-discovery"></div>

    <div class="sectionTitle">HELM ë²¤ì¹˜ë§ˆí¬</div>
    <div class="grid" id="grid-helm"></div>

    <div class="sectionTitle">ì±„ìš© ì‹œê·¸ë„</div>

    <div class="subToolbar">
      <span style="opacity:.85;">ì–¸ì–´ ì˜µì…˜ ì„ íƒ:</span>

      <select class="select" id="langSelect">
        <option value="japanese">Japanese</option>
        <option value="korean">Korean</option>
        <option value="hindi">Hindi</option>
        <option value="arabic">Arabic</option>
        <option value="chinese">Chinese</option>
        <option value="spanish">Spanish</option>
        <option value="french">French</option>
        <option value="bengali">Bengali</option>
        <option value="portuguese">Portuguese</option>
        <option value="russian">Russian</option>
        <option value="urdu">Urdu</option>
        <option value="indonesian">Indonesian</option>
        <option value="german">German</option>
        <option value="swahili">Swahili</option>
        <option value="marathi">Marathi</option>
        <option value="telugu">Telugu</option>
        <option value="turkish">Turkish</option>
        <option value="tamil">Tamil</option>
        <option value="vietnamese">Vietnamese</option>
      </select>

      <input class="text" id="langCustom" placeholder="(ì„ íƒ) ì»¤ìŠ¤í…€ í‚¤ì›Œë“œ ì˜ˆ: Thai, Data.." />

      <span id="customBadge" class="badge" style="display:none;">âœ¨ ì»¤ìŠ¤í…€ ì‚¬ìš© ì¤‘</span>

      <span class="sep">|</span>
      <span class="muted">ë²„íŠ¼ í´ë¦­ ì‹œ í•´ë‹¹ ì±„ìš© ì‚¬ì´íŠ¸ ë‚´ë¶€ ê²€ìƒ‰ìœ¼ë¡œ ì—´ë¦½ë‹ˆë‹¤. ì»¤ìŠ¤í…€ í‚¤ì›Œë“œ ì…ë ¥ ì‹œ ì–¸ì–´ ì˜µì…˜ì€ ë¬´ì‹œë˜ê³  í•´ë‹¹ í‚¤ì›Œë“œë¥¼ ê²€ìƒ‰í•©ë‹ˆë‹¤.</span>
    </div>

    <div class="grid" id="grid-hiring"></div>
  </div>
</header>

<main></main>

<div class="historyWrap">
  <div class="historyHeader">
    <p class="historyTitle">ìµœê·¼ ì ‘ì† ê¸°ë¡</p>
    <button class="btn" id="clearHistoryBtn" style="min-width:110px;">ê¸°ë¡ ì§€ìš°ê¸°</button>
  </div>

  <div class="historyList" id="historyList"></div>
  <div class="muted" style="margin-top:8px; font-size:12px;">
    * ê¸°ë¡ì€ ì‚¬ìš©ì ê°œì¸ localStorageì— ì €ì¥ë©ë‹ˆë‹¤.
  </div>
</div>

<footer>
  conceived &amp; built by cw park
</footer>

<script>
  // ---------------------------
  // History (localStorage)
  // ---------------------------
  const HISTORY_KEY = "radar_open_history_v1";
  const HISTORY_MAX = 60;

  function readHistory(){
    try { return JSON.parse(localStorage.getItem(HISTORY_KEY) || "[]"); }
    catch { return []; }
  }
  function writeHistory(list){
    localStorage.setItem(HISTORY_KEY, JSON.stringify(list));
  }
  function nowKSTString(){
    const d = new Date();
    const pad = (n)=> String(n).padStart(2,"0");
    const yyyy = d.getFullYear();
    const mm = pad(d.getMonth()+1);
    const dd = pad(d.getDate());
    const hh = pad(d.getHours());
    const mi = pad(d.getMinutes());
    return `${yyyy}-${mm}-${dd} ${hh}:${mi}`;
  }

  function addHistory(entry){
    const list = readHistory();
    const top = list[0];
    if (top && top.url === entry.url) {
      list[0] = entry;
    } else {
      list.unshift(entry);
    }
    if (list.length > HISTORY_MAX) list.length = HISTORY_MAX;
    writeHistory(list);
    renderHistory();
  }

  function openAndLog(url, label, tag){
    addHistory({
      time: nowKSTString(),
      label: label || "ì—´ê¸°",
      tag: tag || "",
      url
    });
    window.open(url, "_blank", "noopener,noreferrer");
  }

  function renderHistory(){
    const box = document.getElementById("historyList");
    const list = readHistory();

    if (!list.length) {
      box.innerHTML = `
        <div class="hrow" style="cursor:default;">
          <div class="htime muted">-</div>
          <div class="htext muted">ì•„ì§ ê¸°ë¡ì´ ì—†ì–´ìš”.</div>
          <div class="hopen muted">-</div>
        </div>
      `;
      return;
    }

    box.innerHTML = "";
    list.forEach((h) => {
      const row = document.createElement("div");
      row.className = "hrow";
      row.innerHTML = `
        <div class="htime">${escapeHtml(h.time || "")}</div>
        <div class="htext">
          ${h.tag ? `<span class="metaPill" style="margin-right:6px;">${escapeHtml(h.tag)}</span>` : ``}
          <b>${escapeHtml(h.label || "")}</b>
          <span class="muted" style="margin-left:6px;">${escapeHtml((h.url || "").replace(/^https?:\/\//,""))}</span>
        </div>
        <div class="hopen">ë‹¤ì‹œ ì—´ê¸° â†—</div>
      `;
      row.onclick = () => openAndLog(h.url, h.label, h.tag);
      box.appendChild(row);
    });
  }

  document.getElementById("clearHistoryBtn").onclick = () => {
    writeHistory([]);
    renderHistory();
  };

  // ---------------------------
  // Helpers
  // ---------------------------
  function escapeHtml(str){
    return (str || "")
      .replaceAll("&", "&amp;")
      .replaceAll("<", "&lt;")
      .replaceAll(">", "&gt;")
      .replaceAll('"', "&quot;")
      .replaceAll("'", "&#039;");
  }

  function safeJsonParse(s){
    try { return JSON.parse(s); } catch { return null; }
  }

  // ---------------------------
  // AI Trend Pulse (GDELT titles â†’ AI-topic dictionary counts)
  // ---------------------------
  const TREND_CONFIG = {
    gdeltQuery: '(AI OR "artificial intelligence" OR "generative ai" OR "large language model" OR LLM OR "foundation model" OR "machine learning")',
    gdeltMode: "ArtList",
    gdeltFormat: "json",
    gdeltMaxRecords: 120,
    gdeltTimespan: "14d",

    cacheTtlMs: 30 * 60 * 1000,

    keywordTopN: 10,
    latestTopN: 10,
    cardHeightPx: 420
  };

  const TREND_CACHE_KEY = "radar_trend_pulse_v3";

  const AI_TOPICS = [
    { key:"multimodal", label:"multimodal", terms:[
      "multimodal","vision-language","vision language",
      "vlm","vqa","image+text","video+text",
      "llava","qwen-vl","gpt-4v","clip","siglip"
    ]},
    { key:"video_gen", label:"video generation", terms:[
      "text-to-video","image-to-video","video generation",
      "sora","runway","pika","gen-2","t2v","i2v"
    ]},
    { key:"diffusion", label:"diffusion", terms:[
      "diffusion","stable diffusion","sdxl",
      "latent diffusion","controlnet","lora"
    ]},
    { key:"rlhf", label:"rlhf", terms:[
      "rlhf","rlaif","dpo","ppo",
      "reward model","reward modeling",
      "preference tuning","preference learning"
    ]},
    { key:"alignment", label:"alignment", terms:[
      "alignment","aligned","value alignment",
      "constitutional ai","constitution","helpful harmless honest"
    ]},
    { key:"safety", label:"safety", terms:[
      "ai safety","safe ai","guardrail","guardrails",
      "jailbreak","harmful","content policy",
      "toxicity","misuse","abuse"
    ]},
    { key:"red_teaming", label:"red teaming", terms:[
      "red teaming","red-team","redteam",
      "adversarial testing","prompt injection",
      "jailbreak testing"
    ]},
    { key:"evaluation", label:"evaluation", terms:[
      "evaluation","eval","evals","benchmark","benchmarks",
      "leaderboard","scoring","metric","metrics",
      "mmlu","gsm8k","hellaswag","mt-bench"
    ]},
    { key:"agents", label:"agents", terms:[
      "agent","agents","agentic","autonomous agent",
      "tool use","tool calling","function calling",
      "workflow","planner","executor"
    ]},
    { key:"rag", label:"rag", terms:[
      "rag","retrieval augmented","retrieval-augmented",
      "vector database","vector db","embedding","embeddings",
      "reranker","hybrid search","semantic search"
    ]},
    { key:"memory", label:"memory", terms:[
      "memory","long-term memory","episodic memory",
      "context memory","agent memory"
    ]},
    { key:"inference", label:"inference", terms:[
      "inference","serving","latency","throughput",
      "kv cache","kv-cache","batching",
      "quantization","int4","int8","fp8"
    ]},
    { key:"optimization", label:"optimization", terms:[
      "optimization","kernel fusion","flash attention",
      "flashattention","speculative decoding"
    ]},
    { key:"training", label:"training", terms:[
      "training","pretraining","pre-training",
      "fine-tuning","finetuning","sft",
      "distillation","curriculum learning"
    ]},
    { key:"data", label:"data", terms:[
      "training data","synthetic data","data curation",
      "data labeling","data annotation","self-play"
    ]},
    { key:"moe", label:"moe", terms:[
      "moe","mixture of experts",
      "routing","experts","sparse model"
    ]},
    { key:"context_window", label:"context window", terms:[
      "context window","long context","long-context",
      "128k","200k","1m tokens","million tokens"
    ]},
    { key:"audio_voice", label:"voice", terms:[
      "voice","audio","speech","tts","asr","stt",
      "speech-to-text","text-to-speech",
      "whisper","voice cloning"
    ]},
    { key:"open_source", label:"open source", terms:[
      "open source","open-source","open weight",
      "model weights","apache 2","mit license",
      "llama","mistral","qwen","gemma"
    ]},
    { key:"copyright", label:"copyright", terms:[
      "copyright","licensing","license",
      "lawsuit","fair use","data rights","training rights"
    ]},
    { key:"regulation", label:"regulation", terms:[
      "regulation","ai act","executive order",
      "compliance","governance","policy framework"
    ]},
    { key:"chips", label:"chips", terms:[
      "gpu","h100","h200","b200","blackwell",
      "cuda","nvidia","amd","mi300",
      "tpu","intel gaudi","inference chip"
    ]},
    { key:"lang_english", label:"English", terms:[
      "english language","english data","english llm",
      "english dataset","english corpus"
    ]},
    { key:"lang_japanese", label:"Japanese", terms:[
      "japanese","japanese language","japanese data",
      "japanese llm","japanese dataset","jp language"
    ]},
    { key:"lang_korean", label:"Korean", terms:[
      "korean","korean language","korean data",
      "korean llm","korean dataset","hangul"
    ]},
    { key:"lang_chinese", label:"Chinese", terms:[
      "chinese","mandarin","chinese language",
      "chinese llm","chinese dataset","simplified chinese",
      "traditional chinese"
    ]},
    { key:"lang_hindi", label:"Hindi", terms:[
      "hindi","hindi language","hindi data",
      "indic llm","hindi dataset"
    ]},
    { key:"lang_arabic", label:"Arabic", terms:[
      "arabic","arabic language","arabic data",
      "arabic llm","arabic dataset","msa","modern standard arabic"
    ]},
    { key:"lang_spanish", label:"Spanish", terms:[
      "spanish","spanish language","spanish data",
      "spanish llm","spanish dataset"
    ]},
    { key:"lang_french", label:"French", terms:[
      "french","french language","french data",
      "french llm","french dataset"
    ]},
    { key:"lang_portuguese", label:"Portuguese", terms:[
      "portuguese","brazilian portuguese",
      "portuguese language","portuguese data"
    ]},
    { key:"lang_german", label:"German", terms:[
      "german","german language","german data",
      "german llm"
    ]},
    { key:"lang_indic", label:"Indic languages", terms:[
      "indic languages","indic llm",
      "bengali","tamil","telugu","marathi",
      "urdu","gujarati"
    ]},
    { key:"lang_african", label:"African languages", terms:[
      "african languages","swahili","yoruba",
      "zulu","amharic","low resource languages africa"
    ]},
    { key:"lang_southeast_asia", label:"SEA languages", terms:[
      "vietnamese","thai","indonesian","bahasa",
      "malay","filipino","tagalog","khmer"
    ]}
  ];

  function lc(s){ return (s || "").toLowerCase(); }
  function escapeRegExp(s){ return s.replace(/[.*+?^${}()|[\]\\]/g, '\\$&'); }

  function hasTerm(text, rawTerm){
    const t = lc(text);
    const q = lc(rawTerm).trim();
    if (!q) return false;
    return t.includes(q);
  }

  function countTopicsFromTitles(titles){
    const counts = new Map(AI_TOPICS.map(t => [t.key, 0]));
    let matchedTitles = 0;

    for (const raw of (titles || [])) {
      const t = lc(raw);
      let any = false;

      for (const topic of AI_TOPICS) {
        for (const term of (topic.terms || [])) {
          if (t.includes(lc(term))) {
            counts.set(topic.key, (counts.get(topic.key) || 0) + 1);
            any = true;
            break;
          }
        }
      }
      if (any) matchedTitles += 1;
    }

    const rows = AI_TOPICS
      .map(topic => ({ label: topic.label, key: topic.key, count: counts.get(topic.key) || 0 }))
      .filter(r => r.count > 0)
      .sort((a,b) => b.count - a.count);

    const top = rows.slice(0, TREND_CONFIG.keywordTopN);
    const max = top.reduce((m,r)=>Math.max(m,r.count), 1);

    return { top, max, matchedTitles, totalTitles: (titles || []).length };
  }

  function fetchWithCache(cacheKey, ttlMs, fetcher){
    const now = Date.now();
    try {
      const cached = JSON.parse(localStorage.getItem(cacheKey) || "null");
      if (cached && cached.ts && (now - cached.ts) < ttlMs && cached.data) {
        return Promise.resolve({ data: cached.data, fromCache: true, ts: cached.ts });
      }
    } catch {}

    return fetcher().then((data) => {
      try { localStorage.setItem(cacheKey, JSON.stringify({ ts: now, data })); } catch {}
      return { data, fromCache: false, ts: now };
    });
  }

  async function fetchGdeltArticles(){
    const base = "https://api.gdeltproject.org/api/v2/doc/doc";
    const url =
      `${base}?query=${encodeURIComponent(TREND_CONFIG.gdeltQuery)}` +
      `&mode=${encodeURIComponent(TREND_CONFIG.gdeltMode)}` +
      `&format=${encodeURIComponent(TREND_CONFIG.gdeltFormat)}` +
      `&maxrecords=${encodeURIComponent(String(TREND_CONFIG.gdeltMaxRecords))}` +
      `&timespan=${encodeURIComponent(TREND_CONFIG.gdeltTimespan)}`;

    const res = await fetch(url);
    if (!res.ok) throw new Error(`GDELT ${res.status}`);
    const json = await res.json();

    const arts = (json && json.articles) ? json.articles : [];
    return arts.map(a => ({
      title: a && a.title ? String(a.title) : "",
      url: a && a.url ? String(a.url) : "",
      seendate: a && a.seendate ? String(a.seendate) : "",
      domain: a && a.domain ? String(a.domain) : "",
      sourceCountry: a && a.sourceCountry ? String(a.sourceCountry) : ""
    })).filter(x => x.title);
  }

  function gdeltDateToStamp(seendate){
    const s = String(seendate || "");
    if (!/^\d{14}$/.test(s)) return "";
    const yyyy = s.slice(0,4);
    const mm = s.slice(4,6);
    const dd = s.slice(6,8);
    const hh = s.slice(8,10);
    const mi = s.slice(10,12);
    return `${yyyy}-${mm}-${dd} ${hh}:${mi}`;
  }

  /*
  function kwBarsHtml(top, max){
    if (!top.length) {
      return `<div class="muted" style="font-size:12px; line-height:1.5;">
        ë§¤ì¹­ëœ AI í† í”½ì´ ì—†ì–´ìš”. (AI í† í”½ ë¦¬ìŠ¤íŠ¸ë¥¼ ëŠ˜ë¦¬ê±°ë‚˜, timespanì„ 14dë¡œ ëŠ˜ë ¤ë³´ì„¸ìš”)
      </div>`;
    }

    return `
      <div class="kwList">
        ${top.map((r) => {
          const w = Math.max(6, Math.round((r.count / max) * 100));
          return `
            <div class="kwRowSimple">
              <div class="kwWord">${escapeHtml(r.label)} <span class="kwCountInline">(${r.count})</span></div>
              <div class="kwBar"><span style="width:${w}%"></span></div>
            </div>
          `;
        }).join("")}
      </div>
    `;
  }
*/

function kwBarsHtml(top, max){
  if (!top.length) {
    return `<div class="muted" style="font-size:12px; line-height:1.5;">
      ë§¤ì¹­ëœ AI í† í”½ì´ ì—†ì–´ìš”.
    </div>`;
  }

  return `
    <div class="kw2List">
      ${top.map((r) => {
        const w = Math.max(4, Math.round((r.count / max) * 100));
        return `
          <div class="kw2Row">
            <div class="kw2Word">${escapeHtml(r.label)} <span class="kw2Count">(${r.count})</span></div>
            <div class="kw2Bar"><span style="width:${w}%"></span></div>
          </div>
        `;
      }).join("")}


    </div>
  `;

/*      <div class="kw2Foot">ğŸ§  ê¸°ì‚¬ ì œëª©ì—ì„œ Top ${TREND_CONFIG.keywordTopN} í‚¤ì›Œë“œë¥¼ ë½‘ì•„ìš”. (AI/LLM ê°™ì€ ë„ˆë¬´ í”í•œ ë‹¨ì–´ëŠ” ì œì™¸)</div> */

}



  async function renderTrendPulseNews(forceRefresh=false){
    const box = document.getElementById("trend-news-body");
    const meta = document.getElementById("trend-news-meta");

    box.innerHTML = `<div class="muted" style="font-size:12px;">ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘â€¦</div>`;
    meta.textContent = "";

    const cacheKey = TREND_CACHE_KEY + "_gdelt_articles";
    const ttl = TREND_CONFIG.cacheTtlMs;

    try {
      if (forceRefresh) { try { localStorage.removeItem(cacheKey); } catch {} }

      const { data, fromCache, ts } = await fetchWithCache(cacheKey, ttl, fetchGdeltArticles);
      const articles = data || [];
      const titles = articles.map(a => a.title).filter(Boolean);

      const { top, max, matchedTitles, totalTitles } = countTopicsFromTitles(titles);
      box.innerHTML = kwBarsHtml(top, max);

      const when = new Date(ts);
      const stamp = `${when.getFullYear()}-${String(when.getMonth()+1).padStart(2,"0")}-${String(when.getDate()).padStart(2,"0")} ${String(when.getHours()).padStart(2,"0")}:${String(when.getMinutes()).padStart(2,"0")}`;
      meta.textContent = `${fromCache ? "cached" : "live"} Â· matched ${matchedTitles}/${totalTitles} Â· ${stamp}`;

    } catch (e) {
      box.innerHTML = `<div class="muted" style="font-size:12px; line-height:1.5;">
        ë¶ˆëŸ¬ì˜¤ê¸° ì‹¤íŒ¨ ğŸ˜µ (${escapeHtml(String(e && e.message ? e.message : e))})
      </div>`;
    }
  }

  async function renderTrendPulseHeadlines(forceRefresh=false){
    const box = document.getElementById("trend-headlines-body");
    const meta = document.getElementById("trend-headlines-meta");

    box.innerHTML = `<div class="muted" style="font-size:12px;">ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘â€¦</div>`;
    meta.textContent = "";

    const cacheKey = TREND_CACHE_KEY + "_gdelt_articles";
    const ttl = TREND_CONFIG.cacheTtlMs;

    try {
      if (forceRefresh) { try { localStorage.removeItem(cacheKey); } catch {} }

      const { data, fromCache, ts } = await fetchWithCache(cacheKey, ttl, fetchGdeltArticles);
      const articles = (data || []).filter(a => a && a.title);

      articles.sort((a,b)=> String(b.seendate||"").localeCompare(String(a.seendate||"")));
      const top = articles.slice(0, TREND_CONFIG.latestTopN);

      if (!top.length) {
        box.innerHTML = `<div class="muted" style="font-size:12px; line-height:1.5;">í‘œì‹œí•  ë‰´ìŠ¤ê°€ ì—†ì–´ìš”.</div>`;
      } else {
        box.innerHTML = `
          <div class="newsList">
            ${top.map((a) => {
              const t = gdeltDateToStamp(a.seendate) || "";
              const host = (a.domain || "").replace(/^www\./,"");
              const sub = [t, host].filter(Boolean).join(" Â· ");
              return `
                <div class="newsItem" data-url="${escapeHtml(a.url)}" data-title="${escapeHtml(a.title)}">
                  <div class="newsTitle" title="${escapeHtml(a.title)}">${escapeHtml(a.title)}</div>
                  <div class="newsDomain">${escapeHtml(sub)}</div>
                </div>
              `;
            }).join("")}
          </div>
        `;

        box.querySelectorAll(".newsItem").forEach(row => {
          row.onclick = () => {
            const url = row.getAttribute("data-url") || "";
            const title = row.getAttribute("data-title") || "GDELT article";
            if (url) openAndLog(url, title, "NEWS");
          };
        });
      }

      const when = new Date(ts);
      const stamp = `${when.getFullYear()}-${String(when.getMonth()+1).padStart(2,"0")}-${String(when.getDate()).padStart(2,"0")} ${String(when.getHours()).padStart(2,"0")}:${String(when.getMinutes()).padStart(2,"0")}`;
      meta.textContent = `${fromCache ? "cached" : "live"} Â· Top ${TREND_CONFIG.latestTopN} Â· ${stamp}`;

    } catch (e) {
      box.innerHTML = `<div class="muted" style="font-size:12px; line-height:1.5;">
        ë¶ˆëŸ¬ì˜¤ê¸° ì‹¤íŒ¨ ğŸ˜µ (${escapeHtml(String(e && e.message ? e.message : e))})
      </div>`;
    }
  }

  function renderTrends(){
    const grid = document.getElementById("grid-trends");
    if (!grid) return;

    grid.innerHTML = "";

    const srcUrl = `https://api.gdeltproject.org/api/v2/doc/doc?query=${encodeURIComponent(TREND_CONFIG.gdeltQuery)}&mode=${encodeURIComponent(TREND_CONFIG.gdeltMode)}&format=${encodeURIComponent(TREND_CONFIG.gdeltFormat)}&maxrecords=${encodeURIComponent(String(TREND_CONFIG.gdeltMaxRecords))}&timespan=${encodeURIComponent(TREND_CONFIG.gdeltTimespan)}`;

    const elKw = document.createElement("div");
    elKw.className = "item trendCard";
    elKw.innerHTML = `
      <div class="left">
        <div class="top">
          <span class="tag">NEWS</span>
          <span class="title" style="cursor:default;">AI News Keywords (Top 10)</span>
        </div>
        <div class="metaLine">
          <span class="metaPill">GDELT</span>
          <span class="muted" id="trend-news-meta" style="font-size:12px;"></span>
        </div>
        <div class="kwMeta">ğŸ¥ ìµœê·¼ <span class="mono">${TREND_CONFIG.gdeltMaxRecords}</span>ê°œ ì œëª© ê¸°ë°˜ Â· Top <span class="mono">${TREND_CONFIG.keywordTopN}</span> Â· timespan <span class="mono">${TREND_CONFIG.gdeltTimespan}</span></div>
        <div id="trend-news-body" class="trendBody trendFade"></div>
      </div>

      <div class="actions">
        <button class="btn" id="trend-news-refresh">ìƒˆë¡œê³ ì¹¨</button>
        <button class="btn" id="trend-news-source">ì›ë³¸ â†—</button>
      </div>
    `;
    grid.appendChild(elKw);

    const elList = document.createElement("div");
    elList.className = "item trendCard";
    elList.innerHTML = `
      <div class="left">
        <div class="top">
          <span class="tag">NEWS</span>
          <span class="title" style="cursor:default;">Latest AI News (Top 10)</span>
        </div>
        <div class="metaLine">
          <span class="metaPill">GDELT</span>
          <span class="muted" id="trend-headlines-meta" style="font-size:12px;"></span>
        </div>
        <div class="kwMeta">ğŸ¥ GDELT API ê²°ê³¼ì—ì„œ ìµœì‹ ìˆœ 10ê°œë¥¼ ë½‘ì•„ìš”.</div>
        <!-- âœ… ìš°ì¸¡ë„ ì¹´ë“œ ë‚´ë¶€ ìŠ¤í¬ë¡¤ + í˜ì´ë“œ(ë§ˆìŠ¤í‚¹) -->
        <div id="trend-headlines-body" class="trendBody trendFade"></div>
      </div>

      <div class="actions">
        <button class="btn" id="trend-headlines-refresh">ìƒˆë¡œê³ ì¹¨</button>
        <button class="btn" id="trend-headlines-source">ì›ë³¸ â†—</button>
      </div>
    `;
    grid.appendChild(elList);

    elKw.querySelector("#trend-news-refresh").onclick = () => {
      renderTrendPulseNews(true);
      renderTrendPulseHeadlines(true);
    };
    elKw.querySelector("#trend-news-source").onclick = () => openAndLog(srcUrl, "GDELT / query", "NEWS");

    elList.querySelector("#trend-headlines-refresh").onclick = () => {
      renderTrendPulseNews(true);
      renderTrendPulseHeadlines(true);
    };
    elList.querySelector("#trend-headlines-source").onclick = () => openAndLog(srcUrl, "GDELT / query", "NEWS");

    renderTrendPulseNews(false);
    renderTrendPulseHeadlines(false);
  }

  // ---------------------------
  // Hiring search (simple keywords)
  // ---------------------------
  const SINGLE_LANG_KEYWORD = {
    chinese: "chinese",
    arabic: "arabic",
    bengali: "bengali",
    indonesian: "indonesian bahasa",
    japanese: "japanese",
    korean: "korean",
    hindi: "hindi",
    spanish: "spanish",
    french: "french",
    portuguese: "portuguese",
    russian: "russian",
    urdu: "urdu",
    german: "german",
    swahili: "swahili",
    marathi: "marathi",
    telugu: "telugu",
    turkish: "turkish",
    tamil: "tamil",
    vietnamese: "vietnamese"
  };

  function getPickedLangKeyword(){
    const custom = (document.getElementById("langCustom").value || "").trim();
    if (custom) return custom;
    const key = document.getElementById("langSelect").value;
    return SINGLE_LANG_KEYWORD[key] || "japanese";
  }
  function isCustomActive(){
    return ((document.getElementById("langCustom").value || "").trim().length > 0);
  }
  function updateCustomBadge(){
    document.getElementById("customBadge").style.display = isCustomActive() ? "inline-flex" : "none";
  }

  function buildCompanySearchUrl(companyId, query){
    const q = encodeURIComponent(query);

    if (companyId === "google") return `https://careers.google.com/jobs/results/?q=${q}`;
    if (companyId === "meta") return `https://www.metacareers.com/jobs/?q=${q}`;
    if (companyId === "openai") return `https://openai.com/careers/search/?q=${q}`;
    if (companyId === "anthropic") return `https://boards.greenhouse.io/anthropic?query=${q}`;
    if (companyId === "naver") return `https://recruit.navercloudcorp.com/rcrt/list.do?sw=${q}`;
    return "#";
  }

  function buildHiringUrls(companyId){
    const lang = getPickedLangKeyword();
    return {
      base: buildCompanySearchUrl(companyId, lang),
      speech: buildCompanySearchUrl(companyId, `speech`),
      voice: buildCompanySearchUrl(companyId, `voice`),
      translation: buildCompanySearchUrl(companyId, `translation`),
      localization: buildCompanySearchUrl(companyId, `localization`),
      multimodal: buildCompanySearchUrl(companyId, `multimodal`),
      redteaming: buildCompanySearchUrl(companyId, `red teaming`),
      rlhf: buildCompanySearchUrl(companyId, `rlhf`),
      safety: buildCompanySearchUrl(companyId, `safety`)
    };
  }

  const PAGES = [
    {id:"hf", group:"discovery", title:"Hugging Face Papers Trending", tag:"Low-resource",
     url:"https://huggingface.co/papers/trending?q=Low-resource+languages",
     tip:"â€˜ë°ì´í„° ë¶€ì¡± ì–¸ì–´â€™ ê´€ë ¨ ìµœì‹  ë…¼ë¬¸/íŠ¸ë Œë“œ ë¦¬ìŠ¤íŠ¸."},
    {id:"slator", group:"discovery", title:"Slator ê²€ìƒ‰: Low-resource languages", tag:"Industry",
     url:"https://slator.com/?s=Low-resource+languages",
     tip:"ë¹…í…Œí¬ì˜ ì–¸ì–´ í™•ì¥, íŒŒíŠ¸ë„ˆì‹­, í”„ë¡œê·¸ë¨ ê´€ë ¨"},
    {id:"xtreme", group:"discovery", title:"XTREME (Google Research)", tag:"Benchmark",
     url:"https://sites.research.google/xtreme",
     tip:"ë‹¤êµ­ì–´ ë²¤ì¹˜ë§ˆí¬ (ì–¸ì–´ë³„ FM ì„±ëŠ¥ ë¹„êµ)"},
    {id:"sea", group:"helm", title:"HELM SEAHELM", tag:"SEA",
     url:"https://crfm.stanford.edu/helm/seahelm/latest/",
     tip:"ë™ë‚¨ì•„(SEA) ì–¸ì–´ë³„ FM ì„±ëŠ¥ ë¹„êµ"},
    {id:"thai", group:"helm", title:"HELM ThaiExam", tag:"TH",
     url:"https://crfm.stanford.edu/helm/thaiexam/latest/",
     tip:"íƒœêµ­ì–´(Thai) FM ì„±ëŠ¥ ë¹„êµ"},
    {id:"arabic", group:"helm", title:"HELM Arabic", tag:"AR",
     url:"https://crfm.stanford.edu/helm/arabic/latest/",
     tip:"ì•„ëì–´(Arabic) FM ì„±ëŠ¥ ë¹„êµ"},
    {id:"cleva", group:"helm", title:"HELM CLEVA", tag:"CN",
     url:"https://crfm.stanford.edu/helm/cleva/latest/",
     tip:"ì¤‘êµ­ì–´(Chinese) FM ì„±ëŠ¥ ë¹„êµ"},
    {id:"afr", group:"helm", title:"HELM Afr (MMLU + WinoGrande)", tag:"AFR",
     url:"https://crfm.stanford.edu/helm/mmlu-winogrande-afr/latest/",
     tip:"ì•„í”„ë¦¬ì¹´ì–´(AFR) FM ì„±ëŠ¥ ë¹„êµ"},
    {id:"hire_google", group:"hiring", title:"Google ì±„ìš©", tag:"Google", companyId:"google",
     tip:"ì–¸ì–´ ì˜µì…˜ / ì»¤ìŠ¤í…€ í‚¤ì›Œë“œ / í€µ ë²„íŠ¼ìœ¼ë¡œ Google ì±„ìš© ë‚´ë¶€ ê²€ìƒ‰"},
    {id:"hire_meta", group:"hiring", title:"Meta ì±„ìš©", tag:"Meta", companyId:"meta",
     tip:"ì–¸ì–´ ì˜µì…˜ / ì»¤ìŠ¤í…€ í‚¤ì›Œë“œ / í€µ ë²„íŠ¼ìœ¼ë¡œ Meta ì±„ìš© ë‚´ë¶€ ê²€ìƒ‰"},
    {id:"hire_openai", group:"hiring", title:"OpenAI ì±„ìš©", tag:"OpenAI", companyId:"openai",
     tip:"ì–¸ì–´ ì˜µì…˜ / ì»¤ìŠ¤í…€ í‚¤ì›Œë“œ / í€µ ë²„íŠ¼ìœ¼ë¡œ OpenAI ì±„ìš© ë‚´ë¶€ ê²€ìƒ‰"},
    {id:"hire_naver", group:"hiring", title:"NAVER ì±„ìš©", tag:"NAVER", companyId:"naver",
     tip:"ì–¸ì–´ ì˜µì…˜ / ì»¤ìŠ¤í…€ í‚¤ì›Œë“œ / í€µ ë²„íŠ¼ìœ¼ë¡œ NAVER ì±„ìš© ë‚´ë¶€ ê²€ìƒ‰"}
  ];

  function render(group){
    const grid = document.getElementById(`grid-${group}`);
    grid.innerHTML = "";

    PAGES.filter(p=>p.group===group).forEach(p=>{
      const el = document.createElement("div");
      el.className = "item";

      if(group !== "hiring"){
        el.innerHTML = `
          <div class="left">
            <div class="top">
              <span class="tag">${p.tag}</span>
              <span class="title" title="í´ë¦­í•˜ë©´ ì›ë¬¸ìœ¼ë¡œ ì—´ë¦¼">${p.title}</span>
            </div>
            <div class="tip">ğŸ¶ ${p.tip}</div>
          </div>
          <div class="actions">
            <button class="btn btnOpen">ì›ë¬¸ â†—</button>
          </div>
        `;
        const open = () => openAndLog(p.url, p.title, p.tag);
        el.querySelector(".title").onclick = open;
        el.querySelector(".btnOpen").onclick = open;
        grid.appendChild(el);
        return;
      }

      const langNow = getPickedLangKeyword();
      const customOn = isCustomActive();

      el.innerHTML = `
        <div class="left">
          <div class="top">
            <span class="tag">${p.tag}</span>
            <span class="title" title="í´ë¦­í•˜ë©´ (ì„ íƒ ì–¸ì–´)ë¡œ ê²€ìƒ‰">${p.title}</span>
          </div>

          <div class="metaLine">
            <span style="opacity:.75;">í˜„ì¬:</span>
            <span class="metaPill">${escapeHtml(langNow)}</span>
            ${customOn ? `<span class="metaPill">âœ¨ ì»¤ìŠ¤í…€</span>` : ``}
          </div>

          <div class="tip">ğŸ± ${p.tip}</div>
        </div>

        <div class="actions">
          <button class="btn b_lang">ì–¸ì–´ ì˜µì…˜ or ì»¤ìŠ¤í…€ í‚¤ì›Œë“œ</button>

          <div class="btnRow">
            <button class="btn b_speech">speech</button>
            <button class="btn b_voice">voice</button>
          </div>

          <div class="btnRow">
            <button class="btn b_trans">translation</button>
            <button class="btn b_local">localization</button>
          </div>

          <div class="btnRow">
            <button class="btn b_multimodal">multimodal</button>
            <button class="btn b_red">red teaming</button>
          </div>

          <div class="btnRow">
            <button class="btn b_rlhf">rlhf</button>
            <button class="btn b_safety">safety</button>
          </div>
        </div>
      `;

      const open = (key) => {
        const u = buildHiringUrls(p.companyId)[key];
        const labelMap = {
          base: `${p.title} / ${langNow}`,
          speech: `${p.title} / speech`,
          voice: `${p.title} / voice`,
          translation: `${p.title} / translation`,
          localization: `${p.title} / localization`,
          multimodal: `${p.title} / multimodal`,
          redteaming: `${p.title} / red teaming`,
          rlhf: `${p.title} / rlhf`,
          safety: `${p.title} / safety`
        };
        openAndLog(u, labelMap[key] || `${p.title} / ${langNow}`, p.tag);
      };

      el.querySelector(".title").onclick = () => open("base");
      el.querySelector(".b_lang").onclick = () => open("base");
      el.querySelector(".b_speech").onclick = () => open("speech");
      el.querySelector(".b_voice").onclick = () => open("voice");
      el.querySelector(".b_trans").onclick = () => open("translation");
      el.querySelector(".b_local").onclick = () => open("localization");
      el.querySelector(".b_multimodal").onclick = () => open("multimodal");
      el.querySelector(".b_red").onclick = () => open("redteaming");
      el.querySelector(".b_rlhf").onclick = () => open("rlhf");
      el.querySelector(".b_safety").onclick = () => open("safety");

      grid.appendChild(el);
    });
  }

  function renderAll(){
    document.documentElement.style.setProperty('--trend-card-h', `${TREND_CONFIG.cardHeightPx}px`);
    updateCustomBadge();
    renderTrends();
    render("discovery");
    render("helm");
    render("hiring");
    renderHistory();
  }

  document.getElementById("langSelect").onchange = renderAll;
  document.getElementById("langCustom").addEventListener("input", renderAll);

  updateCustomBadge();
  renderAll();
</script>
</body>
</html>
